var oop = require('oop').oop;

var Node = require('node').Node;



var NodeInstancier = oop.Class({
	name: 'Node Instancier',

	init: function(language) {
		this.language = language != null ? language : null;

		this.hooks = [];
	},

	call: function(element, line, column, start, source) {
		var node = new Node({
			type: {
				language: this.language,
				element: element
			},
			location: {
				start: {
					line: line,
					column: column,
					index: start
				},
				end: {
					index: start + source.length
				}
			},
			source: source
		});

		for (var i = 0, length = this.hooks.length; i < length; i++) {
			this.hooks[i](node);
		}

		return node;
	},

	methods: {
		addHook: function(fn) {
			this.hooks.push(fn);
			return fn;
		}
	}
});



exports.NodeInstancier = NodeInstancier;
exports.NodeClass = Node;
